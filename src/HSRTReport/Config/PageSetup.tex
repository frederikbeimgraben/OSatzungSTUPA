% !TEX root = ../HSRTReport.cls
% ==============================================================================
% Page Setup Configuration Module
% ==============================================================================
% Description: Page layout configuration including headers, footers, and styling
% Author: Frederik Beimgraben
% License: Creative Commons CC BY 4.0
% ==============================================================================

% ==============================================================================
% Required Packages
% ==============================================================================
\RequirePackage{ifthen}
\RequirePackage{xcolor}
\RequirePackage{etoolbox}
\RequirePackage[singlespacing=true]{scrlayer-scrpage}
%\clearpairofpagestyles

% ==============================================================================
% Header and Footer Setup
% ==============================================================================
\AtEndDocument{
  \immediate\write\@auxout{\string\gdef\string\@lastpage{\thepage}}
}

% ------------------------------------------------------------------------------
% Header and Footer Configuration
% ------------------------------------------------------------------------------
% Left header: Chapter number and title
% Right header: Document title
% Left footer: Author and module name
% Center footer: Page number
\setkomafont{pageheadfoot}{\color{gray}\blenderfont}
\setkomafont{pagenumber}{\color{gray}\blenderfont}
\setlength{\footskip}{60pt}
\setlength{\headheight}{30pt}
\setlength{\footheight}{30pt}

\ofoot*{}
\ifoot{Stand \lastChanged}

\cfoot{Seite~\thepage\@ifundefined{@lastpage}{}{~von~\@lastpage}}
\ihead{\ifnum\value{page}=1\else\@title\fi}
\let\oldmarkright\markright
\renewcommand{\markright}[1]{\oldmarkright{\MakeUppercase{#1}}}
\let\oldmarkleft\markleft
\renewcommand{\markleft}[1]{}
\renewcommand{\markboth}[2]{}
\renewcommand{\chaptermark}[1]{\markright{\Roman{chapter}. \MakeUppercase{#1}}}
\renewcommand{\sectionmark}[1]{\oldmarkleft{#1}}
\ohead*{\rightmark\\\leftmark}
\chead*{}

\newpairofpagestyles{tocpage}{
  \ohead{INHALT\\~}
  \ofoot{}
  \ihead{\@title}
  \ifoot{Stand \lastChanged}
  \cfoot{Seite~\thepage\@ifundefined{@lastpage}{}{~von~\@lastpage}}
}

\pagestyle{scrheadings}

% ==============================================================================
% End of Page Setup Module
% ==============================================================================
